{
  "hash": "9c8b85256e49f50b873c8d7f074ebfa3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"07_V_scatterplot_Fig2\"\nsubtitle: \"Fig 1 - Scatterplot\"\nformat: html\neval: FALSE\n---\n\n\n# Type series distribution by time\n\nHere we mapped the flowing of type specimens among regions by time intervals of 50 years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)    # Data manipulation\nlibrary(here)     # File path management\nlibrary(tidyr)    # Data tidying\nlibrary(ggplot2)  # Data visualization\nlibrary(scales)   # Scale transformations and labels\nlibrary(ggarrow)  # Adding arrows to ggplot\n```\n:::\n\n\n\n# Metrics of NBTs distribution in time and regions\n\nHere we combined two metrics, DC and DR by time and regions, to express the changes of NBTs distribution for each of these regions. This is aimed to be the Figure 02 and Figure S2 in the manuscript\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data from 01_C_data_preparation.qmd\n\nflow_period_region_prop <- readr::read_csv(here::here(\"data\", \"processed\", \"flow_period_region_prop.csv\"))\n```\n:::\n\n\nAdd lag values for visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_period_region_prop_lag <- flow_period_region_prop |>\n  dplyr::group_by(region_type) |>\n  dplyr::mutate(new_DC = dplyr::lag(prop_DC),\n                new_DR = dplyr::lag(prop_DR)) |> \n  dplyr::ungroup()\n```\n:::\n\n\n## Figure 2 - Scatterplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_period_region_prop_lag |>\n  dplyr::filter(dplyr::if_all(c(prop_DC, prop_DR, \n                                new_DC, new_DR), \n                              ~ . != 0 | is.na(.))) |> \n  ggplot(aes(x = prop_DC, y = prop_DR, fill = region_type))+\n  geom_hline(yintercept = 0.5, linetype = \"dashed\")+\n  geom_vline(xintercept = 0.5, linetype = \"dashed\")+\n  geom_arrow_segment(\n    aes(x = new_DC, xend = prop_DC,\n        y = new_DR, yend = prop_DR),\n    color = \"grey\",\n    arrow_head = NULL,\n    arrow_mid  = arrow_head_wings(offset = 30,\n                                  inset = 60),\n    resect_head = 2,\n    resect_fins = 2\n  )+\n  geom_point(\n    shape = 21,\n    size = 2.5\n  )+\n  geom_point(\n    aes(x = new_DC ,\n        y = new_DR),\n    alpha = 0.5,\n    shape = 21,\n    size = 2.5\n  )+\n  facet_wrap(.~period,axes = \"all\",\n             axis.labels = \"margins\"\n              )+\n  scale_fill_manual(\n    values = c(\n      \"Europe & Central Asia\" = \"#E64B35FF\",\n      \"East Asia & Pacific\" = \"#4DBBD5FF\",\n      \"North America\" = \"#3C5488FF\",\n      \"South Asia\" = \"#B09C85FF\",\n      \"Latin America & Caribbean\" = \"#00A087FF\",\n      \"Sub-Saharan Africa\" = \"#F39B7FFF\",\n      \"Middle East & North Africa\" = \"#8491B4FF\"\n    )\n  )+\n  scale_x_continuous(\n    labels = scales::label_percent(),\n    expand = expansion(mult = c(0.05, 0))\n  )+\n  scale_y_continuous(\n    labels = scales::label_percent(),\n    expand = expansion(mult = c(0.05, 0))\n  )+\n  theme_classic()+\n  theme(\n    strip.background = element_rect(fill = NA, color = NA),\n    strip.text = element_text(face = \"bold\"),\n    legend.position = \"none\",\n    plot.background = element_blank(),\n    panel.spacing = unit(5, \"pt\"),\n    panel.spacing.x = unit(15, \"pt\"),\n    plot.margin = margin(5,15,5,5,\"pt\"),\n    axis.line = element_line(lineend = \"round\"),\n    axis.text = element_text(color = \"black\"),\n    axis.ticks = element_line(color = \"black\")\n  )+\n  coord_cartesian(xlim = c(0,1),\n                  ylim = c(0,1),\n                  clip = \"off\")\n\n\nggsave(filename = here::here(\"output\", \"Figures\", \"Fig2.png\"), \n       width = 8, height = 5)\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}